!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("jspdf")):"function"==typeof define&&define.amd?define(["jspdf"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).jspdf)}(this,(function(t){"use strict";var e=function(){return(e=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r={FONT_ROW_RATIO:1.15,LINE_HEIGHT:1},n=function(t,e,r){var n=t.split(" ");if(n.length>1)return n;var o=[],i=e,a=0;return n[0].split("").forEach((function(t){" "===t?a+r.getCharWidths(t)[0]/i>e&&(o.push(t),a=0):a+r.getCharWidths(t)[0]/i>e&&(o.push("-"),o.push(t),a=r.getCharWidths(t)[0]/i):a+=r.getCharWidths(t)[0]/i,o.push(t)})),o.join("")};function o(t,n,o,i,a){i=i||{};var s=a.internal.scaleFactor,l=a.internal.getFontSize()/s,c=r.FONT_ROW_RATIO,u=n.reduce((function(t,e){return Math.max(t,e.getActualWidth())}),0);"number"==typeof i.minCellWidth&&(u=Math.max(u,i.minCellWidth));var h=i.minCellHeight||0,d=o.reduce((function(t,e){return t.concat(e.styles.textColor)}),[]),p=function(t,e){var r=t.reduce((function(t,r){return t+(r.contentWidth||r.width)}),0);if(r>e)return!0;var n=t.filter((function(t){return null===t.minWidth})).length;return r+n*t[0].minWidth>e}(n,t);n.forEach((function(t){var e=t.getActualWidth(),r=u;p&&(r=t.minWidth||0),u>r&&(r=u);var n=0;t.cells.forEach((function(t){n=Math.max(n,t.height)})),"number"==typeof i.minCellHeight&&(n=Math.max(n,i.minCellHeight));var o=e>r?l*c*2+n:n;o>h&&(h=o),t.width=r})),i.tableWidth=Math.max(u,n.reduce((function(t,e){return t+e.width}),0)),i.minCellHeight=h,i.isWordbreak=p,i.textColor=d};function i(t,n,a,s){var l,c=(l={},s.styles.fontSize/s.internal.scaleFactor);if(a.forEach((function(t){if(null!=t.content){var e;e=Array.isArray(t.content)?t.content.join(" "):t.content,e=e.replace(/\r\n|\r|\n/g,"\n");var o=s.getStringUnitWidth(e);t.contentWidth=o*c;var u;u="ellipsize",t.content=n.isWordbreak?e:function(t,e,r){if(e<=(u="...")?s.getStringUnitWidth(u)*c:0)return"";if(e<s.getStringUnitWidth(t)*c)for(var n=t.length;n>1;){if(s.getStringUnitWidth(t.substring(0,n-1)+u)*c<=e){t=t.substring(0,n-1)+u;break}t=t.substring(0,n-1)}return t}(e,t.width-t.padding("horizontal"),s),t.height=t.content.split("\n").length*(l[t.section]||(l[t.section]=t.styles.fontSize*r.LINE_HEIGHT*r.FONT_ROW_RATIO))}else t.height=0})),s.autoTableText=function(t,e,r,o){var i=c;s.internal.write("pd",e*s.internal.scaleFactor,r*s.internal.scaleFactor),s.text(t,e,r,o),s.internal.write("Pd"),s.setFontSize(i)}}var a,s=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.pageNumber=1,e}return e(r,t),r.prototype.setPage=function(t){this.pageNumber=t},r.prototype.getPage=function(){return this.pageNumber},r}(((a={}).Cell=function(){function t(t){this.styles={},this.textPos={},this.height=0,this.width=0,this.row=t.row,this.column=t.column,this.section=t.section,this.raw=t.raw,this.spans=t.spans,this.styles=t.styles,this.content=t.content,this.text=t.text}return t.prototype.padding=function(t){var e=this.styles.cellPadding;return"number"==typeof e?e:"vertical"===t?e.top+e.bottom:"horizontal"===t?e.left+e.right:(console.error("Invalid padding direction: "+t),0)},t}(),a.Column=function(){function t(t,e,r){this.cells={},this.width=0,this.minWidth=0,this.wrappedWidth=0,this.dataKey=t,this.index=e,this.section=r}return t.prototype.getActualWidth=function(){return this.width-this.wrappedWidth},t}(),a.HookData=function(t){this.table=t,this.pageNumber=t.pageNumber,this.pageCount=this.pageNumber,this.settings=t.settings,this.cursor=t.cursor,this.doc=t.doc},a.Row=function(){function t(t,e,r){this.cells={},this.height=0,this.maxCellHeight=0,this.x=0,this.y=0,this.pageNumber=1,this.spans={},this.raw=t,this.index=e,this.section=r}return t.prototype.getSpans=function(t){return"number"==typeof t.colSpan&&t.colSpan>1||"number"==typeof t.rowSpan&&t.rowSpan>1},t.prototype.canEntireRowFit=function(t){return this.maxCellHeight<=t},t.prototype.getMinimumRowHeight=function(t,e){var r=this;return t.reduce((function(t,n){var o=e.cells[n.dataKey];if(!o)return 0;var i=o.styles.fontSize*c.FONT_ROW_RATIO;return t>o.content.split("\n").length*i?t:o.content.split("\n").length*i+o.padding("vertical")}),0)},t}(),a.Settings=function(){},a.Table=function(){function t(t,e){var r=this;this.id=t.id,this.settings=e,this.styles=[],this.hooks=[],this.columns=[],this.head=[],this.body=[],this.foot=[],this.pageNumber=1,this.doc=t.doc,this.userStyles=t.userStyles,this.allRows().forEach((function(t){r.styles.push(t.styles)}))}return t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callHooks=function(t,e,r,n){for(var o,i=0,a=this.hooks;i<a.length;i++){var s=a[i];"function"==typeof s[t]&&(o=s[t](e),this.settings.onHook && this.settings.onHook({hook:t,table:this,pageNumber:this.pageNumber,cells:r,row:n,column:o,section:e.section,doc:this.doc,cursor:this.cursor}),!1===o)return!1}return!0},t}(),a.getTheme=function(t){var r={default:{table:{},head:{fontStyle:"bold"},body:{},foot:{fontStyle:"bold"},alternateRow:null},striped:{table:{fillColor:255},head:{fontStyle:"bold",fillColor:[220,220,220]},body:{},foot:{fontStyle:"bold",fillColor:[220,220,220]},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,lineWidth:.1,lineColor:180},head:{fontStyle:"bold",lineWidth:.1,lineColor:180},body:{},foot:{fontStyle:"bold",lineWidth:.1,lineColor:180},alternateRow:null}};return r[t]},a);function l(t){return Object.values(t)}var c,u=function(t,r){for(var n,o=new s.Table(t,r),i=o.settings.margin,a="number"==typeof i.top?i.top:30,l="number"==typeof i.left?i.left:40,c="number"==typeof i.right?i.right:40,u="number"==typeof i.bottom?i.bottom:30,h=o.settings.startY||a,d=o.settings.pageBreak,p=null!==(n=o.settings.showFoot)?n:"everyPage",f=!1!==o.settings.showHead,m=o.doc,g=o.settings.horizontalPageBreak,v=o.settings.horizontalPageBreakRepeat,y=null;g&&null==v;)y=Object.keys(o.head[0].cells);var b=function(t){var e=m.internal.pageSize.getWidth()-l-c,r=m.internal.pageSize.getHeight()-a-u;return o.settings.tableWidth,"auto"===o.settings.tableWidth||"number"!=typeof o.settings.tableWidth||o.settings.tableWidth>e?e:o.settings.tableWidth}(),w={pageNumber:1,settings:o.settings,doc:m,table:o,pageCount:1,cursor:{x:l,y:h},displayHeaderFooter:function(t,e){var r=e.settings.didDrawPage;if(o.callHooks("didDrawPage",t),r)try{r(t)}catch(t){console.error("Exception in didDrawPage hook",t)}else e.settings.didDrawPage=function(){}},addPage:function(){var e=new s.HookData(o);o.pageNumber++,o.callHooks("addPageContent",e),this.displayHeaderFooter(e,o),o.callHooks("afterAddPage",e),this.pageCount=o.pageNumber,y=null;var r=o.settings.margin;m.addPage(),o.pageNumber=1,this.cursor.x=r.left,this.cursor.y=r.top,o.callHooks("didAddPage",e)}};o.cursor=w.cursor;var C={padding:5,lineHeight:r.LINE_HEIGHT,fontSize:10,font:"helvetica",fontStyle:"normal",overflow:"ellipsize",fillColor:!1,textColor:20,halign:"left",valign:"top",cellWidth:"auto"},P=function(){var t,r={};for(t in C)C.hasOwnProperty(t)&&(r[t]=C[t]);return r}(),S=o.doc.getFontList(),T=o.userStyles.font;void 0!==S[T]&&(P.font=T);var k=o.userStyles.fontStyle;-1!==["bold","italic","bolditalic"].indexOf(k)&&(P.fontStyle=k);var x=o.userStyles.fontSize;x&&(P.fontSize=x),o.styles.push(P);for(var A=0,D=Object.values(o.settings.styles).concat(Object.values(o.settings.headStyles)).concat(Object.values(o.settings.bodyStyles)).concat(Object.values(o.settings.footStyles));A<D.length;A++){var O=D[A];O.didParseCell=function(t,e){o.callHooks("didParseCell",t,null,null,null,e),o.settings.didParseCell&&o.settings.didParseCell(t,e)}}var E=Object.assign({},o.settings.columnStyles);for(var _ in E)Object.prototype.hasOwnProperty.call(E,_)&&void 0===E[_]&&delete E[_];return[o,w,b]};var h,d=(((c={}).DidParseCell=function(){},c.WillDrawCell=function(){},c.DidDrawCell=function(){},c.DidDrawPage=function(){},c.WillDrawPage=function(){},c.AddPageContent=function(){},c.AfterAddPage=function(){},c.DidAddPage=function(){},c))(function(){return h=function(t,e,r){return new s.Cell({raw:t,styles:e,section:r})},function(t,e){var r=[],n={},o=t.settings.includeHiddenHtml;if(void 0===o&&(o=!1),!t.settings.html)throw new Error("Cannot parse html if no html input is provided");for(var i,a,l=(t.settings.html,e.querySelectorAll("thead tr")),c=0;c<l.length;c++){a="head";var u=function(t,e,r){var n=new s.Row(t,e,r);return n}(l[c],c,a);t.head.push(u)}for(var d=e.querySelectorAll("tbody tr"),p=0;p<d.length;p++){a="body";u=new s.Row(d[p],p,a);t.body.push(u)}for(var f=e.querySelectorAll("tfoot tr"),m=0;m<f.length;m++){a="foot";u=new s.Row(f[m],m,a);t.foot.push(u)}for(var g=0;g<t.allRows().length;g++){var v=t.allRows()[g];i=0;for(var y=v.raw.cells,b=0;b<y.length;b++){var w=y[b];if(o||w.style.display){var C=r[i];C||(C={dataKey:i},r[i]=C);var P={colSpan:w.colSpan,rowSpan:w.rowSpan,content:L(w)};if(n[g]&&n[g][i]){i+=n[g][i].colSpan||1;continue}var S={hook:function(t,e){return!0},cell:w,row:v,column:C,styles:{}};(v.cells[i]=h(w,S.styles,v.section)).content=P.content,"undefined"!=typeof P.colSpan&&P.colSpan>1&&(n[g]=n[g]||{},n[g][i]=P,B(n,g,i,P.colSpan,P.rowSpan));var T=function(t,e){return e>1?void 0:t}(P.rowSpan,P.rowSpan);void 0!==T&&(i+=P.colSpan||1)}else i++}}t.columns=Object.keys(r).map((function(t){return r[t]}))}});function p(t,e,r,o,i){var a=n(o,e.width-e.padding("horizontal"),i);e.text=a,e.height=e.padding("vertical")+r*a.split("\n").length}var f;function m(t){return t.map((function(t){return t.map((function(t){return""}))}))}function g(t,e,r){var n=m(t),o=m(e);t.forEach((function(t,e){o[r+e]=t})),o.forEach((function(t,e){if(e>=r)return o[e]=t;n[e]=t})),e.forEach((function(t,r){n.forEach((function(e,o){if(e[r]||0===e.length)return;var i=t.slice(r);i.unshift(void 0),e.splice.apply(e,i)}))}));var i={};return t[0].forEach((function(t,e){i[e]=[]})),n.forEach((function(t){t.forEach((function(t,e){i[e].push(t)}))})),e.forEach((function(t){t.forEach((function(t,e){i[e].push(t)}))})),n.concat(o)}var v=function(t){return(f=f||new DOMParser).parseFromString(t,"text/html").body};var y=function(t){var e,r,n;try{e=v(t.settings.html)}catch(e){return console.error("Could not parse html",e),void(t.settings.html=null)}t.settings.html=e,r=t.settings.includeHiddenHtml,void 0===(n=t.settings.useCss)&&(n=!1),d(t,e)};var b,w=function(t){var r,n,o,i;return void 0!==(r=t.settings).didParseCell?o=r.didParseCell:void 0!==(n=t.settings).willParseCell?console.error("willParseCell is deprecated, use didParseCell instead"):"undefined"!=typeof window&&(o=function(){}),void 0!==(i=t.settings)?i:void 0},C={};function P(t,r,n,o,a){o.apply(function(t,r,n,o,a){var l;t.forEach((function(t,c){var u;for(var h in t.cells)if(Object.prototype.hasOwnProperty.call(t.cells,h)){var d=(u=t.cells[h]).styles;d.fontStyle=o.fontStyle,d.font=o.font;var p=e(e({},r),n);d=Object.assign(d,p),i(0,d,0,a)}}))})};function S(t,e){return t.reduce((function(t,r){return t+(r.colSpan?r.colSpan:1)}),0)===e}var T=function(t,r,n){var o,i=t.settings,a=t.hooks,l={},c={},u={};(o=[]).push(l),o.push(c),o.push(u);for(var d=0,p=o;d<p.length;d++){var f=p[d];for(var m in i.styles)Object.prototype.hasOwnProperty.call(i.styles,m)&&(f[m]=e(e({},i.styles[m]),f[m]))}for(var g=0,v=a;g<v.length;g++){var y=v[g];for(var m in y)Object.prototype.hasOwnProperty.call(y,m)&&(l[m]=e(e({},l[m]),y[m]),c[m]=e(e({},c[m]),y[m]),u[m]=e(e({},u[m]),y[m]))}return r.forEach((function(r){t.styles.push(r.styles),i.columnStyles[r.dataKey]&&n.push([r.dataKey,i.columnStyles[r.dataKey
